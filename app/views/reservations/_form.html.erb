<%= semantic_form_for @reservation do |form| %>
	<%= form.inputs do %>
		<%= form.input :user_id %>
		<%= form.input :number_of_participants %>
		<%= form.input :reservation_date, :as => :string, :input_html => { :id => "reservationDatePicker" }%>
		<%= form.input :courts, :as => :check_boxes, :include_blank => false, :collection => Court.all%>
		<%= form.input :start_time, :as => :select, :collection => @time_array.map{|t| t.strftime("%I:%M%p")}, :include_blank => false %>
		<%= form.input :end_time, :as => :select, :collection => @time_array.map{|t| t.strftime("%I:%M%p")}, :include_blank => false %>
	<% end %>
	
	<label>
  		<input type="checkbox" id="show_court_resevations_checkbox" title="Show Open and Reserved Court Times" onchange='showCourtReservations(this);'>
  			Show Open and Reserved Court Times for this Reservation Date
	</label>
	
	<%= form.actions do %>
		<%= form.action :submit, :as => :button %>
	<% end %>
	
	<div id="products">
    <h1 class="ui-widget-header">items</h1>
    <div id="catalog">
        <h2><a href="#">T-Shirts</a></h2>
        <div>
            <ul>
                <li>Lolcat Shirt</li>
                <li>Cheezeburger Shirt</li>
                <li>Buckit Shirt</li>
            </ul>
        </div>
        <h2><a href="#">Bags</a></h2>
        <div>
            <ul>
                <li>Zebra Striped</li>
                <li>Black Leather</li>
                <li>Alligator Leather</li>
            </ul>
        </div>
        <h2><a href="#">Gadgets</a></h2>
        <div>
            <ul>
                <li>iPhone</li>
                <li>iPod</li>
                <li>iPad</li>
            </ul>
        </div>
    </div>
</div>
 
<div id="cart">
    <h1 class="ui-widget-header">Shopping Cart</h1>
    <div class="ui-widget-content">
        <ol>
            <li class="placeholder">Add your items here</li>
        </ol>
    </div>
</div>
	
	<div id="update_content" style="display:none;">		
		<%= render 'court_reservations_table' %>
	</div>
<% end %>

<script type="text/javascript">

	$(document).ready(function() {
		$("#reservationDatePicker").change(function(){
			reloadCourtReservations();
		});
		$('#reservationDatePicker').datepicker({ dateFormat: "yy-mm-dd" });
		
		//shopping cart stuff
		$( "#catalog" ).accordion();
        $( "#catalog li" ).draggable({
            appendTo: "body",
            helper: "clone"
        });
        $( "#cart ol" ).droppable({
            activeClass: "ui-state-default",
            hoverClass: "ui-state-hover",
            accept: ":not(.ui-sortable-helper)",
            drop: function( event, ui ) {
                $( this ).find( ".placeholder" ).remove();
                $( "<li></li>" ).text( ui.draggable.text() ).appendTo( this );
            }
        }).sortable({
            items: "li:not(.placeholder)",
            sort: function() {
                // gets added unintentionally by droppable interacting with sortable
                // using connectWithSortable fixes this, but doesn't allow you to customize active/hoverClass options
                $( this ).removeClass( "ui-state-default" );
            }
        });
	});
		
		function reloadCourtReservations(){
 			var date = $("#reservationDatePicker").val();
  			$.ajax({
    			url: '/reservations/load_court_reservations',
    			data: {'date': date},
    			dataType: 'script',
    			type: 'GET',
    			success: function(data) { data }
  			});
		}
		
		function showCourtReservations(cb){
			if(cb.checked)
			{
				$('#update_content').css('display','inline');
			}
			else
			{
				$('#update_content').css('display','none');
			}
		}
	

</script>